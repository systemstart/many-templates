# domain and siteName are set per-instance in instances.yaml

# Subdomains for each service
subdomains:
  # Infrastructure (shared)
  dex: "auth"
  lldap: "ldap"
  # Fediverse
  minio: "s3"
  mastodon: "social"
  matrix: "matrix"
  element: "chat"
  mobilizon: "events"
  pixelfed: "photos"
  # Office
  ocis: "cloud"
  paperless: "docs"
  stalwart: "mail"
  # SDP
  forgejo: "git"
  woodpecker: "ci"
  harbor: "registry"
  argocd: "cd"

# Kubernetes infrastructure
storageClass: "default"
ingressClassName: "nginx"
certIssuer: "letsencrypt-prod"

# PVC sizes
storage:
  # Infrastructure
  lldap: "1Gi"
  minio: "50Gi"
  # Fediverse
  matrix: "10Gi"
  mobilizon: "20Gi"
  pixelfed: "50Gi"
  # Office
  ocis: "100Gi"
  paperless: "20Gi"
  stalwart: "50Gi"
  # SDP
  forgejo: "50Gi"
  woodpecker: "5Gi"
  harbor:
    registry: "100Gi"
    jobLog: "1Gi"
    trivy: "5Gi"
  # Shared Postgres sidecar size
  postgres: "10Gi"

# LLDAP
lldap:
  adminUsername: "admin"

# MinIO S3 (used by fediverse services)
minio:
  endpoint: "https://{{ .subdomains.minio }}.{{ .domain }}"
  region: "sprawl-west-1"
  buckets:
    mastodon: "mastodon-media"

# SMTP (shared by all services)
smtp:
  host: "{{ .subdomains.stalwart }}.{{ .domain }}"
  port: "587"
  from: "noreply@{{ .domain }}"
  username: "smtp-user"

# Argo CD application management
argocd:
  repoURL: "https://github.com/example/many-sites.git"
  targetRevision: "main"
  basePath: "deploy"

# Dex OIDC client IDs
oidc:
  # Fediverse
  mastodon:
    clientId: "mastodon"
  matrix:
    clientId: "synapse"
  mobilizon:
    clientId: "mobilizon"
  pixelfed:
    clientId: "pixelfed"
  # Office
  ocis:
    clientId: "ocis"
  paperless:
    clientId: "paperless"
  stalwart:
    clientId: "stalwart"
  # SDP
  forgejo:
    clientId: "forgejo"
  harbor:
    clientId: "harbor"
  argocd:
    clientId: "argocd"

# Dex OIDC client catalog â€” each entry defines a service's OIDC integration.
# The dex values.yaml iterates this list, filtered by the instance's "services" list,
# so each instance only gets clients for services it actually deploys.
oidcClients:
  - service: mastodon
    name: Mastodon
    callbackPath: /auth/auth/openid_connect/callback
  - service: matrix
    name: Matrix Synapse
    callbackPath: /_synapse/client/oidc/callback
  - service: mobilizon
    name: Mobilizon
    callbackPath: /auth/keycloak/callback
  - service: pixelfed
    name: Pixelfed
    callbackPath: /auth/oidc/callback
  - service: ocis
    name: ownCloud OCIS
    callbackPath: /
  - service: paperless
    name: Paperless-ngx
    callbackPath: /accounts/oidc/callback
  - service: stalwart
    name: Stalwart Mail
    callbackPath: /auth/oauth
  - service: forgejo
    name: Forgejo
    callbackPath: /user/oauth2/dex/callback
  - service: harbor
    name: Harbor
    callbackPath: /c/oidc/callback
  - service: argocd
    name: Argo CD
    callbackPath: /auth/callback

# Woodpecker authenticates via Forgejo OAuth2 (not Dex directly)
woodpecker:
  forgejoClientId: "woodpecker-ci"

# External Secrets Operator
eso:
  secretStoreName: "cluster-secret-store"
  remotePathPrefix: "site/{{ .siteName }}"
