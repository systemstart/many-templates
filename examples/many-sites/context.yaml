# domain and siteName are set per-instance in instances.yaml

# Subdomains for each service
subdomains:
  # Infrastructure (shared)
  dex: "auth"
  lldap: "ldap"
  # Fediverse
  mastodon: "social"
  matrix: "matrix"
  element: "chat"
  mobilizon: "events"
  pixelfed: "photos"
  # Development
  forgejo: "git"
  woodpecker: "ci"
  harbor: "registry"

# Kubernetes infrastructure
storageClass: "default"
ingressClassName: "nginx"
certIssuer: "letsencrypt-prod"

# PVC sizes
storage:
  # Infrastructure
  lldap: "1Gi"
  # Fediverse
  matrix: "10Gi"
  mobilizon: "20Gi"
  pixelfed: "50Gi"
  # Development
  forgejo: "50Gi"
  woodpecker: "5Gi"
  harbor:
    registry: "100Gi"
    jobLog: "1Gi"
    trivy: "5Gi"
  # Shared Postgres sidecar size
  postgres: "10Gi"

# LLDAP
lldap:
  adminUsername: "admin"

# External S3 (used by fediverse services)
s3:
  hostname: "s3.example"
  endpoint: "https://s3.example"
  region: "us-east-1"
  buckets:
    mastodon: "mastodon-media"

# External SMTP (shared by all services)
smtp:
  host: "smtp.example"
  port: "587"
  from: "noreply@{{ .domain }}"
  username: "smtp-user"

# Dex OIDC client IDs
oidc:
  mastodon:
    clientId: "mastodon"
  matrix:
    clientId: "synapse"
  mobilizon:
    clientId: "mobilizon"
  pixelfed:
    clientId: "pixelfed"
  forgejo:
    clientId: "forgejo"
  harbor:
    clientId: "harbor"

# Dex OIDC client catalog â€” each entry defines a service's OIDC integration.
# The dex values.yaml iterates this list, filtered by the instance's "services" list,
# so each instance only gets clients for services it actually deploys.
oidcClients:
  - service: mastodon
    name: Mastodon
    callbackPath: /auth/auth/openid_connect/callback
  - service: matrix
    name: Matrix Synapse
    callbackPath: /_synapse/client/oidc/callback
  - service: mobilizon
    name: Mobilizon
    callbackPath: /auth/keycloak/callback
  - service: pixelfed
    name: Pixelfed
    callbackPath: /auth/oidc/callback
  - service: forgejo
    name: Forgejo
    callbackPath: /user/oauth2/dex/callback
  - service: harbor
    name: Harbor
    callbackPath: /c/oidc/callback

# Woodpecker authenticates via Forgejo OAuth2 (not Dex directly)
woodpecker:
  forgejoClientId: "woodpecker-ci"

# External Secrets Operator
eso:
  secretStoreName: "cluster-secret-store"
  remotePathPrefix: "site/{{ .siteName }}"
